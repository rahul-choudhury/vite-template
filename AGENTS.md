# Repository Guidelines

## Project Structure & Module Organization
- `src/main.tsx` wires TanStack Router and bootstraps the React app; keep bootstrap logic minimal here.
- `src/routes` holds route layouts and loaders, while `routeTree.gen.ts` is generated by the router plugin—do not edit it manually.
- `src/components` hosts reusable UI, with demos under `components/demos`; colocate styles and stories with their components when feasible.
- Shared logic lives in `src/lib`, `src/hooks`, `src/api`, and `src/types`; unit tests sit beside sources as `*.test.ts` or `*.test.tsx`.
- Core configuration sits in `vite.config.ts`, `tsconfig*.json`, `eslint.config.js`, and global CSS in `src/index.css`.

## Build, Test, and Development Commands
- `pnpm install` installs dependencies (pnpm is pinned in `package.json`).
- `pnpm dev` starts the Vite dev server with hot reloading on localhost.
- `pnpm build` runs TypeScript project references and produces the production bundle in `dist/`.
- `pnpm preview` serves the built bundle for final smoke tests.
- `pnpm lint`, `pnpm typecheck`, and `pnpm format:check` guard ESLint, TypeScript, and Prettier rules; use `pnpm format` to apply fixes.
- `pnpm test` runs the Vitest suite headlessly; append `--ui` or `--runInBand` when diagnosing flaky tests.

## Coding Style & Naming Conventions
- Use kebab case for file names.
- Write new code in TypeScript. Use `PascalCase` for React components, `camelCase` for hooks/utilities, `SNAKE_CASE` for global variables and `kebab-case` for directories.
- DO NOT add `import React from "react"` to the top of a new react component file.
- Prefer named exports over default exports.
- Prefer functional components, React hooks, and TanStack Router data loaders over bespoke stateful patterns.
- ALWAYS USE the `cn` util for writing conditional tailwind classes. DO NOT use template literals.
- Prefer using the `function` keyword when creating components/functions over arrow functions
- Avoid `any` at all costs. Always prefer `unknown` over `any`.
- Narrow down types and avoid type assertions.
- Prettier enforces a 2-space indent, trailing commas, and double quotes—avoid manual formatting and rerun `pnpm format` after larger edits.
- ESLint extends TypeScript and react-hooks presets; resolve all warnings prior to review.

## shadcn/ui components Best Practices

### Popover and Select Components in Dialogs
When using Popover or Select components inside Dialog components, always add `modal={true}` to prevent scroll behavior issues.
 
### Dialog close button action
- **Never use `AlertDialogAction` or `DialogClose`** for actions that require loading states or error handling
- **Always use regular `Button`** in dialog footers when you need to:
  - Show loading states during async operations
  - Handle errors without auto-closing the dialog
  - Manually control when the dialog closes
- **Use controlled dialogs for async operation**: Manage dialog state with `useState` and the `open` prop rather than relying on built-in close triggers

## Testing Guidelines
- Vitest with Testing Library covers units and UI; colocate specs beside the implementation as `*.test.ts(x)`.
- Target meaningful behavior assertions over snapshots, and cover edge cases introduced by new features.
- Run `pnpm test` locally before committing; add `--coverage` when validating critical or bug-fix paths.

## Commit & Pull Request Guidelines
- Follow the conventional commit prefixes visible in history (`docs:`, `test:`, `refactor:`, `ci:`). Keep subjects imperative and under 72 characters.
- Ensure `pnpm lint`, `pnpm typecheck`, and `pnpm test` are green before pushing; mention the verification in your PR description.
- Reference related issues, describe key changes, and include screenshots or recordings for UI-affecting work.
- Keep PRs focused and incremental; split sweeping refactors into reviewable checkpoints.
